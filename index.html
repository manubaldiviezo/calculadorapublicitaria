<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANU | Unit Economics Validator</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand: #FF4400; /* Naranja MANU */
            --brand-dim: rgba(255, 68, 0, 0.1);
            --bg-core: #09090b;
            --bg-card: #121214;
            --border: #27272a;
            --text-main: #e4e4e7;
            --text-muted: #71717a;
            
            /* Logic Colors */
            --profit: #10b981; /* Verde */
            --warning: #f59e0b; /* Amarillo */
            --critical: #ef4444; /* Rojo */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-core);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            padding: 1.5rem 3rem;
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(9, 9, 11, 0.95);
        }

        .brand-logo { font-family: 'Rajdhani', sans-serif; font-weight: 700; font-size: 1.8rem; text-transform: uppercase; letter-spacing: 1px; }
        .brand-logo span { color: var(--brand); }
        .methodology-tag { font-size: 0.75rem; background: #222; padding: 4px 10px; border-radius: 4px; color: #aaa; margin-left: 15px; vertical-align: middle; font-family: 'Inter'; }

        /* --- LAYOUT --- */
        .calculator-grid {
            display: grid;
            grid-template-columns: 400px 1fr;
            flex: 1;
            height: calc(100vh - 85px);
        }

        /* --- LEFT: BUSINESS DATA --- */
        .inputs-panel {
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 2.5rem;
            display: flex; flex-direction: column; gap: 2rem;
            overflow-y: auto;
        }

        .section-title {
            font-size: 0.85rem; color: var(--brand); text-transform: uppercase; font-weight: 700; letter-spacing: 1px; margin-bottom: 1rem;
            display: flex; align-items: center; gap: 8px;
        }

        .input-wrapper { margin-bottom: 1.5rem; }
        
        label { display: block; font-size: 0.85rem; font-weight: 500; color: #ccc; margin-bottom: 8px; }
        
        input, select {
            width: 100%;
            background: #000;
            border: 1px solid var(--border);
            color: #fff;
            padding: 14px;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s;
        }
        input:focus, select:focus { border-color: var(--brand); box-shadow: 0 0 0 2px var(--brand-dim); }

        .helper-text { font-size: 0.75rem; color: #555; margin-top: 6px; }

        /* --- RIGHT: ANALYSIS --- */
        .analysis-panel {
            padding: 3rem;
            background: radial-gradient(circle at top right, #1a0a0a, #09090b);
            overflow-y: auto;
            display: flex; flex-direction: column; gap: 2rem;
        }

        /* Top Cards */
        .stats-row {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;
        }

        .stat-box {
            background: rgba(255,255,255,0.02);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
        }
        .stat-box.highlight { background: linear-gradient(180deg, rgba(255, 68, 0, 0.05), transparent); border-color: rgba(255, 68, 0, 0.3); }

        .stat-label { font-size: 0.75rem; text-transform: uppercase; color: var(--text-muted); font-weight: 700; margin-bottom: 10px; }
        .stat-val { font-family: 'Rajdhani', sans-serif; font-size: 2.5rem; font-weight: 700; color: #fff; line-height: 1; }
        .stat-sub { font-size: 0.85rem; margin-top: 8px; opacity: 0.8; }

        /* The ROAS Scale Visualizer */
        .scale-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2.5rem;
            margin-top: 1rem;
        }

        .scale-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 3rem; display: flex; justify-content: space-between; }

        .visual-track-wrapper { position: relative; height: 60px; margin-top: 20px; }
        
        .track-bg {
            width: 100%; height: 12px; background: #222; border-radius: 6px; position: absolute; top: 20px;
        }

        /* Zonas de color en el track */
        .zone-loss { position: absolute; height: 100%; background: var(--critical); border-radius: 6px 0 0 6px; opacity: 0.3; }
        .zone-profit { position: absolute; height: 100%; background: var(--profit); border-radius: 0 6px 6px 0; opacity: 0.3; }

        /* Marcadores */
        .marker {
            position: absolute; top: 0; transform: translateX(-50%);
            display: flex; flex-direction: column; align-items: center;
            transition: left 0.5s ease-out;
        }
        .marker-line { width: 2px; height: 50px; background: #fff; }
        .marker-label { font-size: 0.7rem; font-weight: 700; margin-bottom: 5px; text-transform: uppercase; white-space: nowrap; }
        .marker-val { font-size: 0.9rem; font-weight: 700; margin-top: 5px; background: #000; padding: 2px 6px; border-radius: 4px; border: 1px solid #333; }

        .m-be .marker-line { background: var(--critical); }
        .m-be .marker-label { color: var(--critical); }
        
        .m-target .marker-line { background: var(--profit); height: 60px; top: -10px; width: 3px; }
        .m-target .marker-label { color: var(--profit); font-size: 0.8rem; }
        
        .m-market .marker-line { background: var(--text-muted); border-style: dashed; }
        .m-market .marker-label { color: var(--text-muted); }

        /* Advice Box */
        .advice-panel {
            margin-top: 2rem;
            padding: 1.5rem;
            border-left: 4px solid #333;
            background: rgba(255,255,255,0.02);
            border-radius: 0 8px 8px 0;
        }

        @media (max-width: 1000px) {
            .calculator-grid { grid-template-columns: 1fr; }
            .stats-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <div class="brand-logo">MANU <span>/ PROFIT ARCHITECT</span></div>
    <span class="methodology-tag">Metodolog칤a: Unit Economics</span>
</header>

<div class="calculator-grid">
    
    <div class="inputs-panel">
        
        <div class="section-title">1. Configuraci칩n de Nicho</div>
        <div class="input-wrapper">
            <label>Selecciona tu Industria</label>
            <select id="niche" onchange="calculate()">
                <option value="fashion" data-roas="4.5">Moda & Ropa (ROAS Est. 4.5x)</option>
                <option value="beauty" data-roas="3.5">Belleza & Cosm칠tica (ROAS Est. 3.5x)</option>
                <option value="tech" data-roas="3.0">Tecnolog칤a / Gadgets (ROAS Est. 3.0x)</option>
                <option value="service" data-roas="6.0">Servicios / B2B (ROAS Est. 6.0x)</option>
                <option value="info" data-roas="3.5">Infoproductos (ROAS Est. 3.5x)</option>
                <option value="realestate" data-roas="15.0">Inmobiliaria (ROAS Est. 15x)</option>
            </select>
            <div class="helper-text">Usamos el rendimiento promedio real de agencias en este sector como referencia.</div>
        </div>

        <div class="section-title">2. Finanzas del Producto</div>
        <div class="input-wrapper">
            <label>Meta de Facturaci칩n ($)</label>
            <input type="number" id="revenueGoal" value="10000" oninput="calculate()">
        </div>

        <div class="input-wrapper">
            <label>Precio de Venta (AOV) ($)</label>
            <input type="number" id="price" value="60" oninput="calculate()">
        </div>

        <div class="input-wrapper">
            <label>Costo Total Producto (COGS + Env칤o + Tax) ($)</label>
            <input type="number" id="cost" value="25" oninput="calculate()">
            <div class="helper-text">Incluye costo de f치brica, empaquetado, impuestos y comisi칩n de pasarela.</div>
        </div>

    </div>

    <div class="analysis-panel">
        
        <div class="stats-row">
            <div class="stat-box highlight">
                <div class="stat-label">Inversi칩n Necesaria (Est.)</div>
                <div class="stat-val" id="res-invest">$0</div>
                <div class="stat-sub">Basado en el ROAS de Mercado</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">CPA Objetivo (M치ximo)</div>
                <div class="stat-val" style="color: var(--brand);" id="res-target-cpa">$0</div>
                <div class="stat-sub">Lo m치ximo que puedes pagar por venta</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Utilidad Neta Proyectada</div>
                <div class="stat-val" style="color: var(--profit);" id="res-profit">$0</div>
                <div class="stat-sub" id="res-margin">0% Margen Neto</div>
            </div>
        </div>

        <div class="scale-container">
            <div class="scale-title">
                <span>An치lisis de Viabilidad & ROAS</span>
                <span id="viability-badge" style="font-size:0.8rem; background:#333; padding:5px 10px; border-radius:4px;">CALCULANDO</span>
            </div>
            
            <p style="color:#888; font-size:0.9rem; margin-bottom: 2rem;">
                Comparamos tu <strong>Punto de Equilibrio (Break-Even)</strong> contra la <strong>Realidad del Mercado</strong>.
            </p>

            <div class="visual-track-wrapper">
                <div class="track-bg"></div>
                <div class="zone-loss" id="zone-loss" style="width: 30%;"></div>
                <div class="zone-profit" id="zone-profit" style="left: 30%; width: 70%;"></div>

                <div class="marker m-be" id="mark-be">
                    <span class="marker-label">Break Even</span>
                    <span class="marker-line"></span>
                    <span class="marker-val" id="val-be">0.0x</span>
                </div>

                <div class="marker m-market" id="mark-market">
                    <span class="marker-label">Mercado</span>
                    <span class="marker-line"></span>
                    <span class="marker-val" id="val-market">0.0x</span>
                </div>
            </div>
            
            <div style="display:flex; justify-content:space-between; margin-top:60px; font-size:0.75rem; color:#666;">
                <div>ZONA DE P칄RDIDA</div>
                <div>ZONA DE GANANCIA</div>
            </div>
        </div>

        <div class="advice-panel" id="advice-box" style="border-color: #333;">
            <div style="color: #fff; font-weight: 700; margin-bottom: 10px; font-size:1.1rem;">Diagn칩stico Estrat칠gico</div>
            <p style="color: #aaa; line-height: 1.6; font-size: 0.95rem;" id="advice-text">
                Ingresa tus datos para ver el an치lisis.
            </p>
        </div>

    </div>
</div>

<script>
    function calculate() {
        // 1. Obtener Datos
        const revenueGoal = parseFloat(document.getElementById('revenueGoal').value) || 0;
        const price = parseFloat(document.getElementById('price').value) || 0;
        const cost = parseFloat(document.getElementById('cost').value) || 0;
        
        // Obtener ROAS de Mercado del Select (Data Attributes)
        const nicheSelect = document.getElementById('niche');
        const marketROAS = parseFloat(nicheSelect.options[nicheSelect.selectedIndex].dataset.roas);

        if(revenueGoal === 0 || price === 0) return;

        // 2. C치lculo de Unit Economics (Matem치tica Pura)
        const grossMargin = price - cost;
        const grossMarginPerc = (grossMargin / price);
        
        // Break Even ROAS: El punto exacto donde Ingresos = Costos
        // F칩rmula: 1 / Margen Bruto %
        let breakEvenROAS = 1 / grossMarginPerc;
        
        // Target CPA (Cost Per Acquisition): Lo m치ximo que podemos pagar para quedar tablas
        // (Aunque lo ideal es pagar menos para tener ganancia)
        const maxCPA = grossMargin; // Si pagas esto, sales tablas (profit 0)
        
        // CPA Realista (basado en Mercado)
        // Si el mercado da un ROAS de X, el CPA ser치 Precio / ROAS
        const realisticCPA = price / marketROAS;

        // 3. Proyecci칩n Financiera usando Datos de Mercado
        const investmentNeeded = revenueGoal / marketROAS;
        const totalSales = Math.ceil(revenueGoal / price);
        const totalCOGS = totalSales * cost;
        const projectedProfit = revenueGoal - totalCOGS - investmentNeeded;
        const projectedMargin = (projectedProfit / revenueGoal) * 100;

        // 4. Renderizar Textos
        document.getElementById('res-invest').innerText = fmtMoney(investmentNeeded);
        document.getElementById('res-target-cpa').innerText = fmtMoney(maxCPA); // Mostramos el CPA M치ximo Permisible
        document.getElementById('res-profit').innerText = fmtMoney(projectedProfit);
        document.getElementById('res-margin').innerText = projectedMargin.toFixed(1) + "% Margen Neto";

        // Color Profit
        if(projectedProfit < 0) {
            document.getElementById('res-profit').style.color = "var(--critical)";
        } else {
            document.getElementById('res-profit').style.color = "var(--profit)";
        }

        // 5. Renderizar Gr치fico (La Escala)
        // Definimos el rango del gr치fico. M치ximo ser치 el mayor entre BE y Mercado * 1.5
        const maxScale = Math.max(breakEvenROAS, marketROAS) * 1.5;
        
        // Posiciones Porcentuales (0 a 100%)
        const posBE = (breakEvenROAS / maxScale) * 100;
        const posMarket = (marketROAS / maxScale) * 100;

        // Mover Marcadores
        moveMarker('mark-be', posBE, breakEvenROAS);
        moveMarker('mark-market', posMarket, marketROAS);

        // Ajustar Zonas de Color
        document.getElementById('zone-loss').style.width = posBE + "%";
        document.getElementById('zone-profit').style.left = posBE + "%";
        document.getElementById('zone-profit').style.width = (100 - posBE) + "%";

        // 6. Generar Diagn칩stico (L칩gica de Experto)
        generateAdvice(breakEvenROAS, marketROAS, projectedMargin, maxCPA, realisticCPA);
    }

    function moveMarker(id, percent, val) {
        const el = document.getElementById(id);
        // Limitar para que no se salga
        if(percent > 95) percent = 95;
        if(percent < 0) percent = 0;
        
        el.style.left = percent + "%";
        document.getElementById(id.replace('mark', 'val')).innerText = val.toFixed(2) + "x";
    }

    function generateAdvice(be, market, margin, maxCPA, realCPA) {
        const badge = document.getElementById('viability-badge');
        const box = document.getElementById('advice-box');
        const text = document.getElementById('advice-text');
        
        let status = "";
        let color = "";
        let message = "";

        // Caso 1: Break Even es mayor que el Mercado (IMPOSIBLE SER RENTABLE)
        if (be > market) {
            status = "NO VIABLE";
            color = "var(--critical)";
            message = `游띔 <strong>ALTO RIESGO:</strong> Tu negocio necesita un ROAS de ${be.toFixed(2)}x para no perder dinero, pero el mercado en este nicho suele dar ${market.toFixed(2)}x. <br><br>
            Esto significa que <strong>el costo de publicidad es m치s alto que tu margen</strong>. <br>
            Tu CPA M치ximo es ${fmtMoney(maxCPA)}, pero conseguir un cliente costar치 aprox ${fmtMoney(realCPA)}. <br>
            <strong>Soluci칩n:</strong> Debes subir precios, bajar costos de producto o aumentar el LTV antes de invertir.`;
        } 
        // Caso 2: Rentable pero arriesgado (Margen bajo)
        else if (margin < 15) {
            status = "MARGEN AJUSTADO";
            color = "var(--warning)";
            message = `丘멆잺 <strong>PRECAUCI칍N:</strong> Eres rentable, pero con poco margen de error (${margin.toFixed(1)}%). <br><br>
            Tu Break Even (${be.toFixed(2)}x) est치 muy cerca del promedio del mercado. Si los costos de publicidad suben un poco (ej. en Navidad), podr칤as perder dinero. <br>
            <strong>Estrategia:</strong> Enf칩cate en vender Packs o Bundles para aumentar el Ticket Promedio y alejarte del Break Even.`;
        }
        // Caso 3: Rentable y Saludable
        else {
            status = "EXCELENTE";
            color = "var(--profit)";
            message = `游 <strong>LUZ VERDE:</strong> Tienes una estructura financiera s칩lida. <br><br>
            Tu Break Even es bajo (${be.toFixed(2)}x) comparado con el potencial del mercado (${market.toFixed(2)}x). Esto te deja un margen de seguridad amplio. <br>
            Puedes permitirte pagar hasta ${fmtMoney(maxCPA)} por cliente, pero probablemente los conseguir치s por ${fmtMoney(realCPA)}. 춰Es momento de escalar!`;
        }

        badge.innerText = status;
        badge.style.background = color;
        badge.style.color = "#000"; // Contrast text
        box.style.borderColor = color;
        text.innerHTML = message;
    }

    function fmtMoney(num) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(num);
    }

    // Init
    calculate();
</script>

</body>
</html>
