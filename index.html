<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANU | Calculadora Estratégica</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand: #FF3300; /* Naranja MANU */
            --bg-main: #121212; /* Negro carbón elegante */
            --bg-panel: #1c1c1c;
            --border: #333333;
            --text-primary: #ffffff;
            --text-secondary: #999999;
        }

        * { border-box: border-box; margin: 0; padding: 0; outline: none; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-primary);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- SECCIÓN IZQUIERDA: INPUTS --- */
        .input-panel {
            width: 400px;
            background: var(--bg-panel);
            border-right: 1px solid var(--border);
            padding: 40px;
            display: flex;
            flex-direction: column;
        }

        .brand-header {
            font-weight: 700; font-size: 1.2rem; letter-spacing: 1px; margin-bottom: 40px;
        }
        .brand-header span { color: var(--brand); }

        .form-group { margin-bottom: 25px; }
        
        label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input, select {
            width: 100%;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus, select:focus { border-color: var(--brand); }

        .margin-info {
            margin-top: auto;
            padding: 20px;
            background: rgba(255, 51, 0, 0.05);
            border-radius: 8px;
            border: 1px solid #333;
        }
        .margin-label { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 5px; }
        .margin-value { font-size: 1.5rem; font-weight: 700; color: var(--brand); }

        /* --- SECCIÓN DERECHA: OUTPUTS --- */
        .output-panel {
            flex: 1;
            padding: 50px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .hero-section {
            margin-bottom: 50px;
        }

        .section-title { font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 20px; font-weight: 600; }

        .hero-card {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            border-left: 4px solid var(--brand);
        }

        .stat-box .label { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 10px; }
        .stat-box .value { font-size: 2.5rem; font-weight: 700; color: #fff; line-height: 1.1; }
        .stat-box .sub { font-size: 0.9rem; color: var(--brand); margin-top: 10px; font-weight: 500; }

        /* Tabla Comparativa Minimalista */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th {
            text-align: left;
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .comparison-table td {
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
            font-size: 1.1rem;
        }

        .scenario-name { font-weight: 600; font-size: 1rem; }
        .roas-tag { display: inline-block; padding: 4px 8px; background: #222; border-radius: 4px; font-size: 0.9rem; font-weight: 700; }
        .profit-val { font-weight: 700; }

        /* Responsive rápido */
        @media (max-width: 900px) {
            body { flex-direction: column; height: auto; }
            .input-panel { width: 100%; border-right: none; border-bottom: 1px solid var(--border); }
            .hero-card { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="input-panel">
        <div class="brand-header">MANU <span>/ ESTRATEGIA</span></div>

        <div class="form-group">
            <label>1. Industria / Nicho</label>
            <select id="niche" onchange="calculate()">
                <option value="ecom">E-commerce (Retail/Moda)</option>
                <option value="service">Servicios / B2B / High Ticket</option>
                <option value="info">Infoproductos / Digital</option>
                <option value="local">Negocio Local (Leads)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>2. Meta de Facturación Mensual ($)</label>
            <input type="number" id="revenueTarget" value="10000" placeholder="Ej. 10000" oninput="calculate()">
        </div>

        <div class="form-group">
            <label>3. Ticket Promedio de Venta ($)</label>
            <input type="number" id="aov" value="80" placeholder="Ej. 80" oninput="calculate()">
        </div>

        <div class="form-group">
            <label>4. Costo del Producto/Servicio (COGS) ($)</label>
            <input type="number" id="cost" value="30" placeholder="Ej. 30" oninput="calculate()">
        </div>

        <div class="margin-info">
            <div class="margin-label">Tu Margen Bruto Actual:</div>
            <div class="margin-value" id="grossMarginDisplay">0%</div>
        </div>
    </div>

    <div class="output-panel">
        
        <div class="hero-section">
            <div class="section-title">Proyección Objetivo (Escenario Realista)</div>
            <div class="hero-card">
                <div class="stat-box">
                    <div class="label">Inversión Ads Sugerida</div>
                    <div class="value" id="main-spend">$0</div>
                    <div class="sub">Presupuesto Mensual</div>
                </div>
                <div class="stat-box">
                    <div class="label">ROAS Objetivo</div>
                    <div class="value" id="main-roas">0.0x</div>
                    <div class="sub">Retorno Saludable</div>
                </div>
                <div class="stat-box">
                    <div class="label">Utilidad Neta Estimada</div>
                    <div class="value" style="color: var(--brand);" id="main-profit">$0</div>
                    <div class="sub" id="main-margin">0% Margen Final</div>
                </div>
            </div>
        </div>

        <div>
            <div class="section-title">Comparativa de Escenarios</div>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th width="25%">Escenario</th>
                        <th width="25%">ROAS Base</th>
                        <th width="25%">Inversión Necesaria</th>
                        <th width="25%">Utilidad Neta</th>
                    </tr>
                </thead>
                <tbody id="scenarioTableBody">
                    </tbody>
            </table>
        </div>

    </div>

<script>
    // Configuración de ROAS realistas por industria
    // No usamos 2x. Usamos rangos que permiten escalar.
    const nicheTargets = {
        ecom: { conservative: 3.5, realistic: 5.0, scalable: 8.0 },
        service: { conservative: 4.0, realistic: 7.0, scalable: 12.0 },
        info: { conservative: 3.0, realistic: 5.0, scalable: 9.0 },
        local: { conservative: 4.0, realistic: 6.5, scalable: 10.0 }
    };

    function calculate() {
        const niche = document.getElementById('niche').value;
        const revenueTarget = parseFloat(document.getElementById('revenueTarget').value) || 0;
        const aov = parseFloat(document.getElementById('aov').value) || 0;
        const cost = parseFloat(document.getElementById('cost').value) || 0;

        if(revenueTarget === 0 || aov === 0) return;

        // 1. Calcular Márgenes Base
        const grossMarginUnit = aov - cost;
        const grossMarginPerc = (grossMarginUnit / aov);
        document.getElementById('grossMarginDisplay').innerText = (grossMarginPerc * 100).toFixed(0) + "%";
        
        const breakEvenROAS = 1 / grossMarginPerc;

        // 2. Obtener ROAS Targets del Nicho
        let targets = nicheTargets[niche];

        // AJUSTE DE SEGURIDAD: Si el margen es muy malo, subimos los ROAS mínimos
        // para asegurar que incluso el escenario conservador no dé pérdidas.
        let safeConservative = Math.max(targets.conservative, breakEvenROAS * 1.2); // Al menos 20% sobre BE
        let safeRealistic = Math.max(targets.realistic, safeConservative * 1.4);
        let safeScalable = Math.max(targets.scalable, safeRealistic * 1.5);

        const scenarios = [
            { name: "Conservador", roas: safeConservative },
            { name: "Objetivo (Realista)", roas: safeRealistic, isMain: true },
            { name: "Escalable (Ideal)", roas: safeScalable }
        ];

        const tbody = document.getElementById('scenarioTableBody');
        tbody.innerHTML = ''; // Limpiar tabla

        scenarios.forEach(sc => {
            // Cálculo Inverso: Cuánto invertir para lograr la meta con ese ROAS
            const investment = revenueTarget / sc.roas;
            
            // Costos Totales
            const unitsSold = revenueTarget / aov;
            const totalCOGS = unitsSold * cost;
            const netProfit = revenueTarget - totalCOGS - investment;
            const finalMargin = (netProfit / revenueTarget) * 100;

            // Llenar Datos Principales (Hero Section)
            if(sc.isMain) {
                document.getElementById('main-spend').innerText = fmtMoney(investment);
                document.getElementById('main-roas').innerText = sc.roas.toFixed(1) + "x";
                document.getElementById('main-profit').innerText = fmtMoney(netProfit);
                document.getElementById('main-margin').innerText = finalMargin.toFixed(1) + "% Margen Final";
            }

            // Llenar Tabla
            const row = `
                <tr>
                    <td class="scenario-name">${sc.name}</td>
                    <td><span class="roas-tag" style="${sc.roas < breakEvenROAS + 0.5 ? 'color:#ff4444' : ''}">${sc.roas.toFixed(1)}x</span></td>
                    <td>${fmtMoney(investment)}</td>
                    <td class="profit-val" style="color: ${netProfit > 0 ? 'var(--brand)' : '#ff4444'}">${fmtMoney(netProfit)}</td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    }

    function fmtMoney(num) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(num);
    }

    // Inicializar
    calculate();
</script>

</body>
</html>
