<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecci칩n de Rentabilidad Comercial | MANU</title>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand: #FF4400; /* Naranja MANU */
            --brand-dark: #cc3600;
            
            /* Colores Financieros */
            --positive: #00C853; /* Verde Dinero */
            --negative: #FF3D00; /* Rojo Alerta */
            --neutral: #FFD600;  /* Amarillo Precauci칩n */
            
            /* Interfaz Sobria (Terrenal) */
            --bg-page: #0F1115;  /* Gris muy oscuro, no negro absoluto */
            --bg-panel: #181A20; /* Panel elevado */
            --bg-field: #23262F; /* Inputs */
            --border: #353945;   /* Bordes sutiles */
            --text-main: #FFFFFF;
            --text-sub: #B1B5C3;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }

        body {
            font-family: 'Public Sans', sans-serif;
            background-color: var(--bg-page);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- HEADER --- */
        header {
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
            padding: 1.2rem 3rem;
            display: flex; align-items: center; justify-content: space-between;
        }
        
        .brand-block h1 { font-size: 1.2rem; font-weight: 700; color: #fff; letter-spacing: -0.5px; }
        .brand-block span { color: var(--brand); }
        .brand-desc { font-size: 0.8rem; color: var(--text-sub); margin-top: 2px; }

        /* --- MAIN LAYOUT --- */
        .container {
            display: grid;
            grid-template-columns: 450px 1fr; /* Panel Inputs m치s ancho para comodidad */
            flex: 1;
            height: calc(100vh - 75px);
        }

        /* --- LEFT: DATA INPUTS --- */
        .sidebar {
            background: var(--bg-panel);
            border-right: 1px solid var(--border);
            padding: 2rem;
            overflow-y: auto;
            display: flex; flex-direction: column; gap: 2rem;
        }

        .input-category {
            border-bottom: 1px solid var(--border);
            padding-bottom: 1.5rem;
        }
        .input-category:last-child { border-bottom: none; }

        .category-title {
            font-size: 0.9rem; font-weight: 700; color: var(--brand); text-transform: uppercase; margin-bottom: 1rem;
            display: flex; align-items: center; gap: 8px;
        }

        .row { display: flex; gap: 1rem; margin-bottom: 1rem; }
        .col { flex: 1; }

        label { display: block; font-size: 0.8rem; color: var(--text-sub); margin-bottom: 6px; font-weight: 500; }
        
        input, select {
            width: 100%;
            background: var(--bg-field);
            border: 1px solid var(--border);
            color: #fff;
            padding: 12px;
            border-radius: 6px;
            font-family: inherit; font-size: 0.95rem;
            transition: 0.2s;
        }
        input:focus, select:focus { border-color: var(--brand); background: #2C303A; }

        .note { font-size: 0.75rem; color: #666; margin-top: 4px; line-height: 1.3; }

        /* --- RIGHT: ANALYSIS --- */
        .main-view {
            padding: 3rem;
            overflow-y: auto;
            background: radial-gradient(circle at top right, #1f1515, var(--bg-page));
        }

        /* SUMMARY CARDS */
        .summary-header { margin-bottom: 2rem; }
        .summary-header h2 { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
        
        .cards-container {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-bottom: 3rem;
        }

        .metric-card {
            background: var(--bg-panel); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem;
            position: relative; overflow: hidden;
        }
        .metric-card.primary { border-top: 3px solid var(--brand); }
        
        .metric-label { font-size: 0.8rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 10px; }
        .metric-value { font-size: 2.2rem; font-weight: 700; color: #fff; }
        .metric-context { font-size: 0.8rem; margin-top: 8px; color: var(--text-sub); padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.05); }

        /* FINANCIAL STATEMENT (Estado de Resultados) */
        .statement-box {
            background: var(--bg-panel); border: 1px solid var(--border); border-radius: 8px; padding: 2rem;
            max-width: 800px;
        }

        .st-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; }

        .st-row {
            display: flex; justify-content: space-between; align-items: center; padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.03); font-size: 0.95rem;
        }
        .st-row.sub-row { padding-left: 20px; font-size: 0.85rem; color: var(--text-sub); }
        .st-row.total-row { border-top: 1px solid var(--border); border-bottom: none; font-weight: 700; font-size: 1.1rem; margin-top: 10px; padding-top: 15px; }
        .st-row.highlight-row { background: rgba(255, 68, 0, 0.05); padding-left: 10px; padding-right: 10px; border-radius: 4px; color: var(--brand); font-weight: 600; }

        .educational-tooltip {
            margin-top: 2rem;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid var(--text-sub);
            padding: 1rem;
            font-size: 0.85rem;
            color: var(--text-sub);
            line-height: 1.6;
        }

        /* BREAK EVEN BAR */
        .be-visual { margin-top: 1rem; }
        .be-bar-bg { width: 100%; height: 8px; background: #333; border-radius: 4px; position: relative; margin-top: 10px; }
        .be-fill { height: 100%; border-radius: 4px; transition: width 0.5s; position: absolute; left: 0; }
        .be-marker { position: absolute; top: -15px; transform: translateX(-50%); font-size: 0.75rem; font-weight: 700; color: #fff; }

        @media (max-width: 1100px) {
            .container { grid-template-columns: 1fr; }
            .sidebar { border-right: none; border-bottom: 1px solid var(--border); }
            .cards-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <div class="brand-block">
        <h1>Proyecci칩n de Rentabilidad <span>MANU</span></h1>
        <div class="brand-desc">Planificaci칩n Financiera & Estrategia de Pauta</div>
    </div>
</header>

<div class="container">
    
    <div class="sidebar">
        
        <div class="input-category">
            <div class="category-title">1. Mercado & Objetivo</div>
            <div class="row">
                <div class="col">
                    <label>Rubro (Estimaci칩n ROAS 2025)</label>
                    <select id="niche" onchange="calculate()">
                        <option value="5.0">Moda & Retail (Est. 5.0x)</option>
                        <option value="4.0">Tecnolog칤a (Est. 4.0x)</option>
                        <option value="6.0">Salud & Belleza (Est. 6.0x)</option>
                        <option value="8.0">Servicios B2B (Est. 8.0x)</option>
                        <option value="25.0">Inmobiliaria (Est. 25.0x)</option>
                        <option value="5.0">Educaci칩n (Est. 5.0x)</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>Meta de Facturaci칩n Mensual ($)</label>
                    <input type="number" id="revenue" value="10000" oninput="calculate()">
                </div>
            </div>
        </div>

        <div class="input-category">
            <div class="category-title">2. Econom칤a del Producto</div>
            <div class="row">
                <div class="col">
                    <label>Precio de Venta (AOV) ($)</label>
                    <input type="number" id="price" value="80" oninput="calculate()">
                </div>
                <div class="col">
                    <label>Costo Producto (COGS) ($)</label>
                    <input type="number" id="cost" value="25" oninput="calculate()">
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>Impuestos (% Ventas)</label>
                    <input type="number" id="tax" value="13" placeholder="IVA/IT" oninput="calculate()">
                </div>
                <div class="col">
                    <label>Pasarela Pago (%)</label>
                    <input type="number" id="fee" value="4" placeholder="Tarjeta" oninput="calculate()">
                </div>
            </div>
        </div>

        <div class="input-category">
            <div class="category-title">3. Costos Operativos (Fijos/Mes)</div>
            <p style="font-size:0.8rem; color:#888; margin-bottom:10px;">Costos que pagas vendas o no vendas.</p>
            
            <div class="row">
                <div class="col">
                    <label>Equipo / Sueldos ($)</label>
                    <input type="number" id="fix_salary" value="500" oninput="calculate()">
                </div>
                <div class="col">
                    <label>Alquiler / Oficina ($)</label>
                    <input type="number" id="fix_rent" value="200" oninput="calculate()">
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>Software / Suscripciones ($)</label>
                    <input type="number" id="fix_soft" value="100" placeholder="Shopify, Hosting" oninput="calculate()">
                </div>
                <div class="col">
                    <label>Fee Agencia / Consultor ($)</label>
                    <input type="number" id="fix_agency" value="500" placeholder="Tus Honorarios" oninput="calculate()">
                    <div class="note">Incluye aqu칤 lo que cobras t칰.</div>
                </div>
            </div>
        </div>

    </div>

    <div class="main-view">
        
        <div class="summary-header">
            <h2>Resultados Financieros</h2>
            <p style="color:var(--text-sub)">An치lisis de viabilidad basado en costos operativos completos.</p>
        </div>

        <div class="cards-container">
            <div class="metric-card primary">
                <div class="metric-label">Inversi칩n Publicitaria Sugerida</div>
                <div class="metric-value" id="res-invest">$0</div>
                <div class="metric-context">Calculada para lograr tu meta con ROAS de mercado</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">ROAS de Equilibrio (Total)</div>
                <div class="metric-value" id="res-be">0.0x</div>
                <div class="metric-context" id="be-context">Debes superar esto para ganar dinero</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Utilidad Neta Real</div>
                <div class="metric-value" id="res-profit">$0</div>
                <div class="metric-context" id="res-margin">0% Margen Final</div>
            </div>
        </div>

        <div class="statement-box">
            <div class="st-title">
                <span>Estado de Resultados Proyectado (Mensual)</span>
                <span style="font-size:0.8rem; font-weight:400; color:#888;">Moneda: USD</span>
            </div>

            <div class="st-row">
                <span>(+) Ingresos por Ventas</span>
                <span id="txt-rev">$0</span>
            </div>

            <div class="st-row sub-row">
                <span>(-) Costo de Mercader칤a (COGS)</span>
                <span id="txt-cogs">($0)</span>
            </div>
            <div class="st-row sub-row">
                <span>(-) Impuestos y Comisiones Pasarela</span>
                <span id="txt-vars">($0)</span>
            </div>
            
            <div class="st-row" style="font-weight:600; color:#fff;">
                <span>(=) Margen Bruto</span>
                <span id="txt-gross">$0</span>
            </div>

            <div style="margin: 15px 0;"></div>
            <div class="st-row sub-row">
                <span>(-) Gastos Operativos (Sueldos, Renta, Software)</span>
                <span id="txt-ops">($0)</span>
            </div>
            <div class="st-row sub-row highlight-row" style="margin-bottom: 5px;">
                <span>(-) Honorarios Agencia / Consultor칤a</span>
                <span id="txt-agency">($0)</span>
            </div>

            <div class="st-row">
                <span>(=) Disponible para Publicidad (Pre-Ad Profit)</span>
                <span id="txt-available" style="color:#aaa">$0</span>
            </div>

            <div class="st-row highlight-row" style="background: rgba(255, 68, 0, 0.1);">
                <span>(-) Inversi칩n Publicitaria (Ads)</span>
                <span id="txt-ads">($0)</span>
            </div>

            <div class="st-row total-row">
                <span>(=) UTILIDAD NETA FINAL</span>
                <span id="txt-net">$0</span>
            </div>
        </div>

        <div class="educational-tooltip">
            <strong>游 Fundamentos del C치lculo:</strong><br>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>Costos Fijos vs Variables:</strong> Notar치s que primero restamos lo que cuesta producir (Variable) y luego lo que cuesta operar (Fijo). Solo lo que sobra se puede invertir en publicidad.</li>
                <li><strong>ROAS de Equilibrio Total:</strong> No solo calculamos el ROAS para pagar el producto. Este indicador (<span id="txt-be-expl">0.0x</span>) te dice cu치nto debe retornar cada d칩lar de publicidad para cubrir TAMBI칄N tus sueldos y la agencia. Si el ROAS de mercado es menor a este n칰mero, el negocio no es viable.</li>
            </ul>
        </div>

    </div>
</div>

<script>
    function calculate() {
        // --- 1. DATOS DE ENTRADA ---
        const revenue = parseFloat(document.getElementById('revenue').value) || 0;
        
        // Variables
        const price = parseFloat(document.getElementById('price').value) || 0;
        const costUnit = parseFloat(document.getElementById('cost').value) || 0;
        const taxPercent = parseFloat(document.getElementById('tax').value) / 100 || 0;
        const feePercent = parseFloat(document.getElementById('fee').value) / 100 || 0;
        
        // Operativos Fijos
        const fSalary = parseFloat(document.getElementById('fix_salary').value) || 0;
        const fRent = parseFloat(document.getElementById('fix_rent').value) || 0;
        const fSoft = parseFloat(document.getElementById('fix_soft').value) || 0;
        const fAgency = parseFloat(document.getElementById('fix_agency').value) || 0; // Importante
        
        // Mercado
        const marketROAS = parseFloat(document.getElementById('niche').value);

        if(revenue === 0 || price === 0) return;

        // --- 2. C츼LCULO FINANCIERO PASO A PASO ---
        
        // A. Costos Variables Totales
        const units = revenue / price;
        const totalCOGS = units * costUnit;
        const totalTaxFee = revenue * (taxPercent + feePercent);
        const totalVariable = totalCOGS + totalTaxFee;
        
        // B. Margen Bruto
        const grossMargin = revenue - totalVariable;
        
        // C. Costos Fijos Totales
        const totalFixedOps = fSalary + fRent + fSoft; // Sin agencia
        const totalFixedAll = totalFixedOps + fAgency; // Con agencia
        
        // D. Dinero Disponible para Ads (Pre-Ad Profit)
        const availableForAds = grossMargin - totalFixedAll;
        
        // E. Inversi칩n Publicitaria (Basada en ROAS Mercado)
        const adSpend = revenue / marketROAS;
        
        // F. Utilidad Neta Final
        const netProfit = availableForAds - adSpend;
        const netMargin = (netProfit / revenue) * 100;

        // --- 3. C츼LCULO DE BREAK-EVEN REAL (FUNDAMENTAL) ---
        // El BE ROAS responde: "쮺u치nto debo generar por cada $ de ad para quedar en 0?"
        // Formula: Ingreso = CostoVariable + CostoFijo + (Ingreso/BE_ROAS)
        // BE_ROAS = Ingreso / (MargenBruto - CostosFijos)
        
        let beROAS = 0;
        if (availableForAds <= 0) {
            // Si antes de pagar anuncios ya est치s en negativo (por costos fijos altos)
            beROAS = 999; // Infinito (Imposible)
        } else {
            beROAS = revenue / availableForAds;
        }

        // --- 4. RENDERIZADO DE DATOS ---
        
        // KPIs Superiores
        document.getElementById('res-invest').innerText = fmt(adSpend);
        document.getElementById('res-profit').innerText = fmt(netProfit);
        document.getElementById('res-margin').innerText = netMargin.toFixed(1) + "% Margen Final";
        
        const beEl = document.getElementById('res-be');
        const beExpl = document.getElementById('txt-be-expl');
        
        if (beROAS > 50) {
            beEl.innerText = "NO VIABLE";
            beEl.style.color = "var(--negative)";
            beExpl.innerText = "Imposible";
        } else {
            beEl.innerText = beROAS.toFixed(2) + "x";
            beExpl.innerText = beROAS.toFixed(2) + "x";
            
            // Color Logic
            if(beROAS > marketROAS) {
                beEl.style.color = "var(--negative)"; // Necesitas m치s de lo que el mercado da
                document.getElementById('be-context').innerText = "Riesgo: Mayor al promedio del mercado ("+marketROAS+"x)";
            } else {
                beEl.style.color = "var(--positive)";
                document.getElementById('be-context').innerText = "Saludable: Menor al promedio del mercado ("+marketROAS+"x)";
            }
        }
        
        // Estado de Resultados (Tabla)
        document.getElementById('txt-rev').innerText = fmt(revenue);
        document.getElementById('txt-cogs').innerText = "(" + fmt(totalCOGS) + ")";
        document.getElementById('txt-vars').innerText = "(" + fmt(totalTaxFee) + ")";
        document.getElementById('txt-gross').innerText = fmt(grossMargin);
        
        document.getElementById('txt-ops').innerText = "(" + fmt(totalFixedOps) + ")";
        document.getElementById('txt-agency').innerText = "(" + fmt(fAgency) + ")";
        
        const availEl = document.getElementById('txt-available');
        availEl.innerText = fmt(availableForAds);
        availEl.style.color = availableForAds < 0 ? "var(--negative)" : "#fff";

        document.getElementById('txt-ads').innerText = "(" + fmt(adSpend) + ")";
        
        const netEl = document.getElementById('txt-net');
        netEl.innerText = fmt(netProfit);
        netEl.style.color = netProfit >= 0 ? "var(--positive)" : "var(--negative)";
    }

    function fmt(num) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(num);
    }

    // Inicializar
    calculate();
</script>

</body>
</html>
